let lenis;const marquees=document.querySelectorAll(".marquee"),mm=gsap.matchMedia();function initLenis(){lenis=new Lenis({duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),direction:"vertical",gestureDirection:"vertical",smooth:!0,mouseMultiplier:1,smoothTouch:!1,touchMultiplier:2,infinite:!1,autoRaf:!0,prevent:e=>e.closest(".modal__scroll")}),window.lenis=lenis,document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();e=document.querySelector(this.getAttribute("href"));e&&lenis.scrollTo(e)})}),requestAnimationFrame(function e(t){lenis.raf(t),requestAnimationFrame(e)})}function initModals(){var e=document.querySelectorAll("[data-modal-open]:not([data-modal-open^='modal-reviews-'])"),t=document.querySelectorAll("[data-modal-close]"),o=document.querySelectorAll(".modal:not(#dynamic-video-modal)");e.forEach(o=>{o.addEventListener("click",e=>{e.preventDefault();var e=o.getAttribute("data-modal-open"),t=document.getElementById(e);t&&(t.classList.add("is-active"),document.body.classList.add("modal-open"),console.log(`Modal ${e} opened`),lenis.stop())})}),t.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();e=t.closest(".modal");e&&(e.classList.remove("is-active"),console.log(`Modal ${e.id} closed`),document.querySelector(".modal.is-active")||(document.body.classList.remove("modal-open"),lenis.start()))})}),o.forEach(t=>{t.addEventListener("click",e=>{e.target===t&&(t.classList.remove("is-active"),console.log(`Modal ${t.id} closed by outside click`),document.querySelector(".modal.is-active")||(document.body.classList.remove("modal-open"),lenis.start()))})})}function horizontalLoop(e,t){e=gsap.utils.toArray(e),t=t||{};let r=gsap.timeline({repeat:t.repeat,paused:t.paused,defaults:{ease:"none"},onReverseComplete:()=>r.totalTime(r.rawTime()+100*r.duration())}),s=e.length,o=e[0].offsetLeft,i=[],a=[],n=[],l=0,d=100*(t.speed||1),c=!1===t.snap?e=>e:gsap.utils.snap(t.snap||1),u,m,p,f,g,v;for(gsap.set(e,{xPercent:(e,t)=>{var o=a[e]=parseFloat(gsap.getProperty(t,"width","px"));return n[e]=c(parseFloat(gsap.getProperty(t,"x","px"))/o*100+gsap.getProperty(t,"xPercent")),n[e]}}),gsap.set(e,{x:0}),u=e[s-1].offsetLeft+n[s-1]/100*a[s-1]-o+e[s-1].offsetWidth*gsap.getProperty(e[s-1],"scaleX")+(parseFloat(t.paddingRight)||0),v=0;v<s;v++)g=e[v],m=n[v]/100*a[v],f=(p=g.offsetLeft+m-o)+a[v]*gsap.getProperty(g,"scaleX"),r.to(g,{xPercent:c((m-f)/a[v]*100),duration:f/d},0).fromTo(g,{xPercent:c((m-f+u)/a[v]*100)},{xPercent:n[v],duration:(m-f+u-m)/d,immediateRender:!1},f/d).add("label"+v,p/d),i[v]=p/d;function h(e,t){t=t||{},Math.abs(e-l)>s/2&&(e+=e>l?-s:s);let o=gsap.utils.wrap(0,s,e),a=i[o];return a>r.time()!=e>l&&(t.modifiers={time:gsap.utils.wrap(0,r.duration())},a+=r.duration()*(e>l?1:-1)),l=o,t.overwrite=!0,r.tweenTo(a,t)}return r.next=e=>h(l+1,e),r.previous=e=>h(l-1,e),r.current=()=>l,r.toIndex=(e,t)=>h(e,t),r.times=i,r.progress(1,!0).progress(0,!0),t.reversed&&(r.vars.onReverseComplete(),r.reverse()),r}document.addEventListener("DOMContentLoaded",function(){initLenis(),initModals(),mm.add({isMobile:"(max-width: 699px)",isDesktop:"(min-width: 700px)"},e=>{const o=e.conditions["isDesktop"];marquees.forEach(e=>{var t=e.querySelectorAll(".marquee-item"),e="true"===e.getAttribute("data-reversed");horizontalLoop(t,{repeat:-1,paddingRight:o?40:20,speed:o?.5:.25,reversed:e})})})});